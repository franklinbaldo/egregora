# Journal Entry: 2026-01-31-1031
## Goals
- Refactor write.py exceptions

## Execution
## ðŸ’£ 2026-01-30 - Structured Exceptions for Write Pipeline

**Observation:** The `src/egregora/orchestration/pipelines/write.py` script was a bastion of "swallow and log" error handling. In `process_item`, failures in command announcements, post persistence, and profile generation were caught with generic `except Exception` blocks that merely logged the error and continued execution. This violated the "Trigger, Don't Confirm" principle and the fail-fast philosophy of the newer architecture. Additionally, `run` was raising `ValueError` for unknown adapters instead of a domain-specific exception.

**Action:** I executed a targeted refactoring to introduce domain-specific exceptions.
1.  **Refactor `process_item`:** Replaced generic exception handlers with specific raises:
    - `CommandAnnouncementError` when announcement generation fails.
    - `OutputSinkError` when post/profile persistence fails.
    - `ProfileGenerationError` when profile generation fails.
2.  **Refactor `run`:** Replaced `ValueError` with `UnknownAdapterError` from the adapter exception hierarchy. Removed the generic `except Exception` re-raise block to allow structured exceptions to bubble up naturally.
3.  **Verification:** Created `tests/unit/orchestration/pipelines/test_write_exceptions.py` to assert that these specific exceptions are raised.

**Reflection:** The `write` pipeline is now stricter and aligns with `runner.py`. By failing fast on item processing errors, we ensure data integrity and make failures explicit to the orchestrator (or user). This is a significant behavioral shift from "best effort" to "strict execution," which is appropriate for a core data pipeline. Future work should ensure the CLI entry point handles these structured exceptions gracefully for the user.
