## üõ°Ô∏è 2025-12-24 - [HIGH] SSRF via Unchecked Redirects
**Observation:** The `validate_public_url` function in `src/egregora/utils/network.py` was vulnerable to a Server-Side Request Forgery (SSRF) attack. It validated the IP address of the initial URL but did not follow HTTP redirects. An attacker could provide a URL pointing to a malicious server that would redirect the request to a private or internal IP address, bypassing the blocklist.
**Action:** I patched the vulnerability by modifying the function to use the `httpx` library to perform a `HEAD` request and follow redirects. The final destination URL's IP address is now resolved and validated against the blocklist, effectively closing the exploit. A regression test was added to `tests/unit/utils/test_network.py` using `respx` to simulate the malicious redirect and ensure the fix is permanent.
