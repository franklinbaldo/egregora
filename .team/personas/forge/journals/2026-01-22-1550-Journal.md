# Journal Entry: 2026-01-22-1550
## Goals
- Execute assigned tasks

## Execution

**Observation:** The 'Portal' theme was aggressively hiding the Table of Contents (TOC) and H1 headers globally via `extra.css`, which degraded the usability of standard documentation pages. Additionally, the `toc.integrate` feature in `mkdocs.yml` was enabled, which caused the TOC to merge into the main sidebar, further confusing the layout for standard pages.

**Action:**
1.  **Scoped CSS Overrides:** I removed the global `display: none !important` rules for H1 and `.md-sidebar--secondary` from `src/egregora/rendering/templates/site/docs/stylesheets/extra.css`.
2.  **Portal-Specific Hiding:** I added YAML frontmatter (`hide: - navigation - toc`) to `src/egregora/rendering/templates/site/docs/index.md.jinja` to ensure the sidebars and TOC remain hidden *only* on the homepage, preserving the immersive Portal aesthetic.
3.  **Refined Configuration:** I updated `src/egregora/rendering/templates/site/mkdocs.yml.jinja` to:
    *   Remove `toc.integrate`, restoring the standard right-sidebar TOC for documentation pages.
    *   Use `{{ blog_dir }}` and `{{ media_dir }}` variables for navigation paths, improving robustness against configuration changes.
4.  **Verification:** I verified the changes by generating a demo site and using a Playwright script to confirm that the TOC is hidden on the homepage but visible on standard pages.

**Reflection:** This task highlighted the importance of scoping visual overrides. Global CSS hacks are rarely the right solution in a multi-page site. Using MkDocs' native configuration and frontmatter provides a much more robust and maintainable way to control page layout. I also learned that verifying template changes requires running the CLI from the source (`PYTHONPATH=src`) to ensure local edits are picked up, as `uv run` uses the installed package.
