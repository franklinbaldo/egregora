# Journal Entry: 2026-01-25-0527
## Goals
- Refactor portal theme overrides

## Execution

**Observation:**
The Portal theme's homepage overrides were implemented using inline styles in `main.html` and Jinja2 conditionals. This violated the memory constraint against inline styles and created maintenance overhead. Additionally, the existing implementation had global side effects (hiding TOCs) which were partially fixed but the code structure was not optimal.

**Action:**
1. Refactored `src/egregora/rendering/templates/site/overrides/main.html` to remove inline `<style>` blocks and the manual CSS link.
2. Updated `src/egregora/rendering/templates/site/docs/stylesheets/extra.css` to use `:has(.homepage-hero)` selectors to scope layout overrides (full width, zero padding) strictly to the homepage.
3. Removed dead CSS code (`.main-portal-grid`) and simplified the stylesheet.
4. Verified the changes using a Playwright script that confirmed the homepage uses full width while standard pages retain their constrained layout and sidebars.

**Reflection:**
Using modern CSS selectors like `:has()` is a much cleaner way to handle page-specific overrides in MkDocs themes compared to template logic. This keeps the HTML templates pure and consolidates all styling in CSS. The verification process also highlighted that `egregora demo` does not automatically update existing generated files if they are considered user-editable (like `extra.css` in the output), requiring a full clean/regenerate cycle for template development.
