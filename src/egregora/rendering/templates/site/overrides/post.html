{% extends "main.html" %}

{% block content %}
<article class="md-content__inner md-typeset" data-url="{{ page.url }}">
  <!-- Reading Progress Bar -->
  <div id="reading-progress-bar"></div>

  <!-- Post Header -->
  <header class="post-header">
    <div class="post-tags">
      {% for tag in page.meta.tags %}
      <a href="{{ 'posts/tags.md' | url }}#{{ tag | slugify }}" class="tag">{{ tag }}</a>
      {% endfor %}
    </div>
    <h1>{{ page.title }}</h1>
    <div class="post-meta">
      {% set authors_data = get_authors_data(page.meta.authors) %}
      {% for author in authors_data %}
      <div class="author-container">
        <a href="{{ 'profiles/' ~ author.uuid ~ '.md' | url }}" class="author">
          <img src="{{ author.avatar }}" alt="{{ author.name }}">
          <span>{{ author.name }}</span>
        </a>
        <div class="author-card-wrapper">
          {% include "partials/author_card.html" %}
        </div>
      </div>
      {% endfor %}
      <span class="date">{{ page.meta.date }}</span>
      <span class="reading-time">{{ page.meta.reading_time }} min read</span>
    </div>
    {% if page.meta.summary %}
    <div class="tldr">
      <p>{{ page.meta.summary }}</p>
    </div>
    {% endif %}
  </header>

  {{ page.content }}

  <!-- Related Posts Placeholder -->
  <!-- Replaces the old static section -->
  <section id="related-posts-container" class="related-posts">
    <!-- JS will populate this. If JS fails, this remains empty/invisible -->
  </section>
</article>
{% endblock %}

{% block scripts %}
  {{ super() }}
  <!-- Inject search index path logic if needed, or handle in JS -->
  <script src="{{ 'javascripts/related_posts.js' | url }}"></script>
{% endblock %}
