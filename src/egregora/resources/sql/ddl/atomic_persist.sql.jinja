BEGIN TRANSACTION;
-- Clear existing data to ensure idempotence
DELETE FROM {{ target_table | quote }};

-- Insert new data from the temporary view
{% set quoted_columns = columns | map('quote') | join(', ') %}
INSERT INTO {{ target_table | quote }} ({{ quoted_columns }})
SELECT {{ quoted_columns }}
FROM {{ source_view | quote }};

COMMIT;
